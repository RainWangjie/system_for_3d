"use strict";define(["fullscreen"],function(e){function o(){u.render(r,E)}function t(){window.requestAnimationFrame(t),o()}function n(e,o,t){$("canvas").css({width:e+"px",height:o+"px"}),$(".canvas-model-preview").css({width:"100%",height:o/2+"px"}),u.setSize(e,o)}console.log("h5页面模型预览");var i=2*window.innerWidth,a=2*screen.availHeight,d=i/a,l=i,s=l*d,r=new THREE.Scene;THREE.Loader.Handlers.add(/\.dds$/i,new THREE.DDSLoader);var c=new THREE.MTLLoader;c.setBaseUrl("http://7xs7nv.com1.z0.glb.clouddn.com/"),c.setPath("http://7xs7nv.com1.z0.glb.clouddn.com/"),c.crossOrigin="*",c.setMaterialOptions({side:THREE.DoubleSide}),c.load(mtlUrl,function(e){e.preload();var o=new THREE.OBJLoader;o.setMaterials(e),o.setPath("http://7xs7nv.com1.z0.glb.clouddn.com/"),o.load(objUrl,function(e){model=e,model.scale.set(model_option[0],model_option[0],model_option[0]),model.rotation.x=model_option[1]/180*Math.PI,model.rotation.y=model_option[2]/180*Math.PI,model.rotation.z=model_option[3]/180*Math.PI,model.position.set(model_option[4]||0,model_option[5]||0,model_option[6]||0),r.add(model),$(".canvas-model-preview .preview-img").remove(),$(".canvas-model-preview .moblie-progress").remove(),$(".canvas-model-preview").append(u.domElement)},H,f)});var m=new THREE.PointLight(16777215);m.position.set(-100,200,-100),r.add(m);var p=new THREE.DirectionalLight(16772829);p.position.set(0,0,1).normalize(),r.add(p);var w=new THREE.SpotLight(16777215);w.position.set(-353,-353,500),w.castShadow=!0,r.add(w);var v=new THREE.SpotLight(16777215);v.position.set(-130,483,300),v.castShadow=!0,r.add(v);var h=new THREE.SpotLight(16777215);h.position.set(483,-130,300),h.castShadow=!0,r.add(h),r.add(new THREE.AmbientLight(1052720));var E=new THREE.PerspectiveCamera(45,1/d,.1,1e3);E.position.set(200,200,200),E.lookAt(r.position);var u=new THREE.WebGLRenderer({antialiasing:!0,alpha:!0});u.setSize(l,s);var g=new THREE.OrbitControls(E,document.querySelector(".canvas-model-preview"));g.addEventListener("change",o),t();var H=function(e){if(e.lengthComputable){var o=e.loaded/e.total*100;$(".moblie-progress").html("模型加载"+Math.round(o,2)+"%"),console.log(Math.round(o,2)+"% downloaded")}},f=function(e){};$(".fullscreen").on("tap",function(){90!==window.orientation&&alert("请旋转屏幕！")}),window.onorientationchange=function(){switch(window.orientation){case-90:case 90:console.log("full"),e.full(document.getElementsByClassName("canvas-model-preview")[0]),n(a,i);break;case 0:case 180:n(l,s),e.exitFull()}}});